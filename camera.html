<html>
<head>
<title>Camera Test</title>
<script src="https://code.jquery.com/jquery-3.1.1.js" integrity="sha256-16cdPddA6VdVInumRGo6IbivbERE8p7CQR3HzTBuELA=" crossorigin="anonymous"></script>
<script>
    if (!navigator.mediaDevices) {
    console.log("enumerateDevices() not supported.");
    }
    else
    {

        // List cameras and microphones.
        navigator.mediaDevices.getUserMedia({
            video: {
                width: {
                    min: 1280,
                    ideal: 1920,
                    max: 2560,
                },
                height: {
                    min: 720,
                    ideal: 1080,
                    max: 1440
                },
                facingMode: 'environment',
                zoom:true,
            }
        }).then(function(stream) {
        /* use the stream */
            $("#msg").append("<p>v4 backfacing camera with zoom found</p>")
            document.querySelector('video').srcObject = stream;
            document.querySelector('video').setAttribute('playsinline', true);
            const [track] = stream.getVideoTracks();
            const capabilities = track.getCapabilities();
            const settings = track.getSettings();
            $("#msg").append(`<p>${JSON.stringify(settings)}</p>`)

            //https://googlechrome.github.io/samples/image-capture/update-camera-zoom.html
            track.applyConstraints({advanced: [ {zoom: 2}, {torch: true}, {focusMode:"continuous"} ]});

            // https://stackoverflow.com/a/42075251
            var imageCapture = new ImageCapture(track);

            var imageCaptureConfig = {
                fillLightMode: "torch", /* or "flash" */
                focusMode: "continuous"
            };
            // set the image capture options (e.g. flash light, autofocus, ...)
            imageCapture.setOptions(imageCaptureConfig)
                .catch(function(err){
                    $("#msg").append(`<p>${err}</p>`)
                });

        }).catch(function(err) {
            $("#msg").append(`<p>${err}</p>`)
        });
    }
</script>
<style>
	canvas{
	border:1px solid black;}
</style>
</head>
<body>
    <video id="camera" autoplay></video>
    <div id="msg"></div>
</body>
</html>